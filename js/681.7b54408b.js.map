{"version":3,"file":"js/681.7b54408b.js","mappings":"mNAGA,MACMA,EAAa,CAAEC,MAAO,iBACtBC,EAAa,CAAC,MAOpB,OAA4BC,EAAAA,EAAAA,IAAiB,CAC3CC,OAAQ,QACRC,KAAAA,CAAMC,GCER,MAAMC,GAAYC,EAAAA,EAAAA,IAAwB,MACpCC,GAAeD,EAAAA,EAAAA,IAAI,GACnBE,GAAYF,EAAAA,EAAAA,KAAI,GAChBG,GAAaC,EAAAA,EAAAA,IAAS,IACtBC,GAAWL,EAAAA,EAAAA,IAAsC,IACjDM,EAAcC,GAAmBC,IAClCA,IACHH,EAASI,MAAMF,GAASC,E,EAG1BE,eAAeC,UACRC,EAAAA,EAAAA,MAAYC,MAAMC,IACvBX,EAAMY,QAAQD,EAAKE,UAAU,IAC3BC,OAAM,KACRd,EAAMY,KAAK,CAAEG,SAAU,aAAcC,IAAK,IAC1ChB,EAAMY,KAAK,CAAEG,SAAU,aAAcC,IAAK,IAC1ChB,EAAMY,KAAK,CAAEG,SAAU,aAAcC,IAAK,GAAI,GAEhD,CACA,MAAMC,EAAgBC,IACrB,IAAKtB,EAAUU,MAAO,OACtB,MAAMa,EAASD,EAAEC,OACjB,IAAKvB,EAAUU,MAAMc,SAASD,GAAS,OACvCD,EAAEG,iBACEvB,EAAaQ,OAASN,EAAMsB,OAAS,GACxCd,IAED,MAAMe,EAAgB3B,EAAUU,MAAMkB,iBAAiB,UACvD,IAAIC,EAAe,EACfC,EAAWC,IAEfJ,EAAcK,SAAQ,CAACC,EAASzB,KAC/B,IAAKR,EAAUU,MAAO,OACtB,MAAMwB,EAAOD,EAAQE,wBACfC,EAASC,KAAKC,IAAIJ,EAAKK,IAAMvC,EAAUU,MAAMyB,wBAAwBI,KACvEH,EAASN,IACZD,EAAerB,EACfsB,EAAWM,E,IAIb,IAAII,EAAWX,EAEXP,EAAEmB,OAAS,GAAKD,EAAWb,EAAcD,OAAS,EACrDc,IACUlB,EAAEmB,OAAS,GAAKD,EAAW,GACrCA,IAGD,MAAME,EAAc1C,EAAUU,MAAMiC,cAAc,UAAUH,KACxDE,IACHA,EAAYE,eAAe,CAAEC,SAAU,SAAUC,MAAO,UAAWC,OAAQ,UAC3E7C,EAAaQ,MAAQ8B,E,EDYvB,OCRAQ,EAAAA,EAAAA,KAAUrC,gBACHC,IACFZ,EAAUU,OACbV,EAAUU,MAAMuC,iBAAiB,QAAS5B,GAE3ClB,EAAUO,OAAQ,CAAK,IDGjB,CAACwC,EAAUC,MACRC,EAAAA,EAAAA,OAAcC,EAAAA,EAAAA,IAAoB,MAAO,CAC/C3D,MAAO,sBACP4D,QAAS,YACTrD,IAAKD,EACLuD,QAASlC,GACR,CACAlB,EAAUO,QACN0C,EAAAA,EAAAA,OAAcI,EAAAA,EAAAA,IAAaC,EAAAA,EAAS,CACnCC,IAAK,EACLhE,MAAO,cAETiE,EAAAA,EAAAA,IAAoB,IAAI,IAC5BC,EAAAA,EAAAA,GAAoB,MAAOnE,EAAY,GACpC2D,EAAAA,EAAAA,KAAW,IAAOC,EAAAA,EAAAA,IAAoBQ,EAAAA,GAAW,MAAMC,EAAAA,EAAAA,IAAY1D,GAAO,CAAC2D,EAAMvD,MACxE4C,EAAAA,EAAAA,OAAcC,EAAAA,EAAAA,IAAoB,MAAO,CAC/C3D,MAAO,QACPgE,IAAKlD,EACLwD,GAAI,SAAWxD,GACd,EACDyD,EAAAA,EAAAA,IAAaC,EAAAA,WAAW,CACtBC,MAAOJ,EACP5C,SAAU4C,EAAK5C,SACfiD,SAAS,EACTnE,IAAKM,EAAWC,GAChBY,IAAK2C,EAAK3C,KACT,KAAM,EAAG,CAAC,QAAS,WAAY,SACjC,EAAGzB,MACJ,SAEL,KAEL,I,QE1GA,MAAM0E,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://damao/./src/views/Recommend/index.vue?0616","webpack://damao/./src/views/Recommend/index.vue","webpack://damao/./src/views/Recommend/index.vue?be91"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, createVNode as _createVNode, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-421a2b5a\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"inner-wrapper\" }\nconst _hoisted_2 = [\"id\"]\n\nimport FeedModel from \"@/components/VideoWindow/index.vue\";\nimport Loading from \"@/components/Loadings/loading1.vue\"\nimport { ref, onMounted, reactive } from 'vue';\nimport { getVideos } from \"@/apis/video\";\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'index',\n  setup(__props) {\n\nconst container = ref<HTMLElement | null>(null);\nconst currentIndex = ref(0);\nconst isLoading = ref(true);\nconst items: any = reactive([]);\nconst testRefs = ref<InstanceType<typeof FeedModel>[]>([]);\nconst setTestRef = (index: number) => (el: InstanceType<typeof FeedModel> | null) => {\n\tif (el) {\n\t\ttestRefs.value[index] = el;\n\t}\n};\nasync function loadRecommend() {\n\tawait getVideos().then((data: any) => {\n\t\titems.push(...data.feed_list)\n\t}).catch(() => {\n\t\titems.push({ videoSrc: \"j (11).mp4\", vid: 1 })\n\t\titems.push({ videoSrc: \"j (12).mp4\", vid: 1 })\n\t\titems.push({ videoSrc: \"j (13).mp4\", vid: 1 })\n\t})\n}\nconst handleScroll = (e: WheelEvent) => {\n\tif (!container.value) return;\n\tconst target = e.target as HTMLElement;\n\tif (!container.value.contains(target)) return;\n\te.preventDefault();\n\tif (currentIndex.value >= items.length - 2) {\n\t\tloadRecommend()\n\t}\n\tconst innerElements = container.value.querySelectorAll('.inner');\n\tlet closestIndex = 0;\n\tlet distance = Infinity;\n\n\tinnerElements.forEach((element, index) => {\n\t\tif (!container.value) return;\n\t\tconst rect = element.getBoundingClientRect();\n\t\tconst offset = Math.abs(rect.top - container.value.getBoundingClientRect().top);\n\t\tif (offset < distance) {\n\t\t\tclosestIndex = index;\n\t\t\tdistance = offset;\n\t\t}\n\t});\n\n\tlet newIndex = closestIndex;\n\n\tif (e.deltaY > 0 && newIndex < innerElements.length - 1) {\n\t\tnewIndex++;\n\t} else if (e.deltaY < 0 && newIndex > 0) {\n\t\tnewIndex--;\n\t}\n\n\tconst targetInner = container.value.querySelector(`#inner_${newIndex}`);\n\tif (targetInner) {\n\t\ttargetInner.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });\n\t\tcurrentIndex.value = newIndex;\n\t}\n};\n\nonMounted(async () => {\n\tawait loadRecommend()\n\tif (container.value) {\n\t\tcontainer.value.addEventListener('wheel', handleScroll);\n\t}\n\tisLoading.value = false;\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: \"recommend-container\",\n    ref_key: \"container\",\n    ref: container,\n    onWheel: handleScroll\n  }, [\n    (isLoading.value)\n      ? (_openBlock(), _createBlock(Loading, {\n          key: 0,\n          class: \"loading\"\n        }))\n      : _createCommentVNode(\"\", true),\n    _createElementVNode(\"div\", _hoisted_1, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(items, (item, index) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: \"inner\",\n          key: index,\n          id: 'inner_' + index\n        }, [\n          _createVNode(FeedModel, {\n            modal: item,\n            videoSrc: item.videoSrc,\n            ref_for: true,\n            ref: setTestRef(index),\n            vid: item.vid\n          }, null, 8, [\"modal\", \"videoSrc\", \"vid\"])\n        ], 8, _hoisted_2))\n      }), 128))\n    ])\n  ], 544))\n}\n}\n\n})","<template>\n\t<div class=\"recommend-container\" ref=\"container\" @wheel=\"handleScroll\">\n\t\t<Loading class=\"loading\" v-if=\"isLoading\"></Loading>\n\t\t<div class=\"inner-wrapper\">\n\t\t\t<div class=\"inner\" v-for=\"(item, index) in items\" :key=\"index\" :id=\"'inner_' + index\">\n\t\t\t\t<FeedModel :modal=\"item\" :videoSrc=\"item.videoSrc\" :ref=\"setTestRef(index)\" :vid=\"item.vid\"></FeedModel>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup lang=\"ts\">\nimport FeedModel from \"@/components/VideoWindow/index.vue\";\nimport Loading from \"@/components/Loadings/loading1.vue\"\nimport { ref, onMounted, reactive } from 'vue';\nimport { getVideos } from \"@/apis/video\";\nconst container = ref<HTMLElement | null>(null);\nconst currentIndex = ref(0);\nconst isLoading = ref(true);\nconst items: any = reactive([]);\nconst testRefs = ref<InstanceType<typeof FeedModel>[]>([]);\nconst setTestRef = (index: number) => (el: InstanceType<typeof FeedModel> | null) => {\n\tif (el) {\n\t\ttestRefs.value[index] = el;\n\t}\n};\nasync function loadRecommend() {\n\tawait getVideos().then((data: any) => {\n\t\titems.push(...data.feed_list)\n\t}).catch(() => {\n\t\titems.push({ videoSrc: \"j (11).mp4\", vid: 1 })\n\t\titems.push({ videoSrc: \"j (12).mp4\", vid: 1 })\n\t\titems.push({ videoSrc: \"j (13).mp4\", vid: 1 })\n\t})\n}\nconst handleScroll = (e: WheelEvent) => {\n\tif (!container.value) return;\n\tconst target = e.target as HTMLElement;\n\tif (!container.value.contains(target)) return;\n\te.preventDefault();\n\tif (currentIndex.value >= items.length - 2) {\n\t\tloadRecommend()\n\t}\n\tconst innerElements = container.value.querySelectorAll('.inner');\n\tlet closestIndex = 0;\n\tlet distance = Infinity;\n\n\tinnerElements.forEach((element, index) => {\n\t\tif (!container.value) return;\n\t\tconst rect = element.getBoundingClientRect();\n\t\tconst offset = Math.abs(rect.top - container.value.getBoundingClientRect().top);\n\t\tif (offset < distance) {\n\t\t\tclosestIndex = index;\n\t\t\tdistance = offset;\n\t\t}\n\t});\n\n\tlet newIndex = closestIndex;\n\n\tif (e.deltaY > 0 && newIndex < innerElements.length - 1) {\n\t\tnewIndex++;\n\t} else if (e.deltaY < 0 && newIndex > 0) {\n\t\tnewIndex--;\n\t}\n\n\tconst targetInner = container.value.querySelector(`#inner_${newIndex}`);\n\tif (targetInner) {\n\t\ttargetInner.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });\n\t\tcurrentIndex.value = newIndex;\n\t}\n};\n\nonMounted(async () => {\n\tawait loadRecommend()\n\tif (container.value) {\n\t\tcontainer.value.addEventListener('wheel', handleScroll);\n\t}\n\tisLoading.value = false;\n});\n</script>\n\n<style scoped>\n.recommend-container {\n\theight: 100%;\n\tposition: relative;\n\ttop: 0;\n\tleft: 0;\n\tz-index: 0;\n\toverflow: hidden;\n\n\twidth: 100%;\n\tbackground-color: rgb(22, 24, 35);\n\n}\n\n.inner-wrapper {\n  height: calc(100% - 12px);\n\twidth: 98%;\n}\n\n.inner {\n\theight: 100%;\n\twidth: 100%;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tmargin-bottom: 20px;\n}\n\n.loading {\n\tposition: absolute;\n\tbackground-color: rgb(22, 24, 35);\n\tz-index: 114515;\n\theight: 100%;\n\twidth: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n</style>\n","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=421a2b5a&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-421a2b5a\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_defineComponent","__name","setup","__props","container","ref","currentIndex","isLoading","items","reactive","testRefs","setTestRef","index","el","value","async","loadRecommend","getVideos","then","data","push","feed_list","catch","videoSrc","vid","handleScroll","e","target","contains","preventDefault","length","innerElements","querySelectorAll","closestIndex","distance","Infinity","forEach","element","rect","getBoundingClientRect","offset","Math","abs","top","newIndex","deltaY","targetInner","querySelector","scrollIntoView","behavior","block","inline","onMounted","addEventListener","_ctx","_cache","_openBlock","_createElementBlock","ref_key","onWheel","_createBlock","Loading","key","_createCommentVNode","_createElementVNode","_Fragment","_renderList","item","id","_createVNode","FeedModel","modal","ref_for","__exports__"],"sourceRoot":""}